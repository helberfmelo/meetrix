# Smoke Test - Produção (YCBM P1-2)

Checklist / Evidências (formato PR_YCBM):
- [x] Booking criado com sucesso
- [x] Link de gerenciamento localizado no log (via script db)
- [x] Tela /manage carregou sem erro
- [x] Cancelamento concluído e status atualizado
- [x] Reagendamento concluído e status atualizado
- [x] Desktop validado
- [x] Mobile (viewport simulado) validado

Comandos executados (se aplicável):
```bash
# Baixar logs do servidor para tentar encontrar o token
curl.exe -s -u "opents62:<senha>" ftp://ftp.opentshost.com/public_html/meetrix/storage/logs/laravel.log -o laravel_prod.log

# Como MAIL_MAILER=log não registrou o corpo do e-mail, foi usado script temporário para ler o DB:
$phpCode = @"
<?php
require __DIR__.'/../vendor/autoload.php';
`$app = require_once __DIR__.'/../bootstrap/app.php';
`$kernel = `$app->make(Illuminate\Contracts\Http\Kernel::class);
`$kernel->handle(Illuminate\Http\Request::capture());
`$booking = \App\Models\Booking::latest()->first();
echo json_encode(`$booking->toArray());
"@
Set-Content -Path "get_pdo_token.php" -Value $phpCode -Encoding UTF8
curl.exe -s -T "get_pdo_token.php" -u "opents62:<senha>" ftp://ftp.opentshost.com/public_html/meetrix/public/get_pdo_token.php
curl.exe -s -o resultado.json https://meetrix.opentshost.com/get_pdo_token.php
curl.exe -s -u "opents62:<senha>" -Q "-DELE public_html/meetrix/public/get_pdo_token.php" ftp://ftp.opentshost.com/
```

Resultado:
FAIL (teste inicial)

Se FAIL, detalhe o ponto exato e a mensagem exibida:
A tela `/manage` carregou normalmente com o token, e o reagendamento ocorreu com sucesso. Porém, a funcionalidade de Cancelamento falhou. O botão "Cancelar Agendamento" (Cancel booking) não responde a nenhum clique (nenhum JavaScript é engatilhado, a tela não tem erro no console e nenhuma requisição de rede ou modal é aberta). O comportamento ocorre tanto no Desktop quanto no Mobile. Ao tentar acionar via teclado `Enter`, a aplicação redireciona para `/onboarding` misteriosamente.

Observações:
Os logs em `laravel.log` continham apenas metadados do email (MAIL_MAILER=log), o que impediu extrair a URL diretamente. A extração foi feita com um script isolado de consulta ao banco e removido imediatamente, cumprindo a diretiva de ajuste ad-hoc do AI_OPERATIONS_GUIDE.
O Reagendamento executou bem localizando o YCBM.
O Cancelamento precisará de uma investigação profunda na view de _manage_, possivelmente há um erro de bind (`@click`) do próprio botão no Vue ou bloqueios de componentes filhos impedindo a submissão correta do Inertia/Zod.

---

## Correcao Aplicada (2026-02-22)

- Removida confirmacao via `window.confirm` e substituida por etapa inline de confirmacao no proprio UI.
- Feedback e erro agora sao resetados antes das acoes.
- Build executado: `npm run build` (OK).

## Reteste Concluído (2026-02-22)

- [x] Reexecutar smoke em producao (desktop + mobile) focando no fluxo de cancelamento.

**Resultado Geral: OK**
O fluxo de cancelamento inline funcionou perfeitamente e o status mudou para "Agendamento cancelado". Reagendamentos e criação também validados e funcionando.
Nenhuma edição de código ou configuração foi realizada neste reteste.
Evidência adicional: `C:\Users\helbe\.gemini\antigravity\brain\e0fae095-0fe9-454e-8e90-51f5eb256255\walkthrough.md.resolved`.
